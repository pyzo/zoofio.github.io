<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>Zoof UI</title>
    <style>html{height:100%;}body{height:100%;margin:0px;}.zf-layout{width:100%;height:100%;margin:0px;padding:0px;border-spacing:0px;border:0px;}.hcell.vcell{padding:0px;}.zf-pinboard{position:relative;}.zf-hbox,.zf-vbox{display:-webkit-flex;display:-ms-flexbox;display:-ms-flex;display:-moz-flex;display:flex;}.box-align-center{-webkit-align-items:center;-ms-align-items:center;-moz-align-items:center;align-items:center;}.box-align-center{-webkit-align-items:center;-ms-align-items:center;-moz-align-items:center;align-items:center;}.zf-hbox>.zf-hbox,.zf-hbox>.zf-vbox{width:auto;}.zf-vbox>.zf-hbox,.zf-vbox>.zf-vbox{height:auto;}.zf-hbox{-webkit-flex-flow:row;-ms-flex-flow:row;-moz-flex-flow:row;flex-flow:row;width:100%;}.zf-vbox{-webkit-flex-flow:column;-ms-flex-flow:column;-moz-flex-flow:column;flex-flow:column;height:100%;width:100%;}.zf-hbox>div,.zf-vbox>div{-webkit-flex-grow:1;-ms-flex-grow:1;-moz-flex-grow:1;flex-grow:1;}.flex0{-ms-flex-grow:0;-webkit-flex-grow:0;flex-grow:0;}.flex1{-ms-flex-grow:1;-webkit-flex-grow:1;flex-grow:1;}.flex2{-ms-flex-grow:2;-webkit-flex-grow:2;flex-grow:2;}.flex3{-ms-flex-grow:3;-webkit-flex-grow:3;flex-grow:3;}.flex4{-ms-flex-grow:4;-webkit-flex-grow:4;flex-grow:4;}.flex5{-ms-flex-grow:5;-webkit-flex-grow:5;flex-grow:5;}.flex6{-ms-flex-grow:6;-webkit-flex-grow:6;flex-grow:6;}.flex7{-ms-flex-grow:7;-webkit-flex-grow:7;flex-grow:7;}.flex8{-ms-flex-grow:8;-webkit-flex-grow:8;flex-grow:8;}.flex9{-ms-flex-grow:9;-webkit-flex-grow:9;flex-grow:9;}td.vflex>.zf-widget{height:100%;}td.hflex>.zf-widget{width:100%;}.zf-pinboard>.zf-widget{position:absolute;}.zf-form>tr>td>.zf-label{text-align:right;}.zf-widget{box-sizing:border-box;white-space:nowrap;overflow:hidden;}.zf-label{}body{background-color:#eee;}</style>
</head>

<body id='body'>
    <script>
        // Init zoof namespace
        window.zoof = {};
        zoof.ws = null;
        zoof.isExported = true;
        
        zoof.runExportedApp = function () {
            zoof.command('ICON 7f7761124390.ico');
            zoof.command('TITLE Zoof app');
            zoof.command('EXEC zoof.createVBox({"margin": "0px", "pos": [0, 0], "className": "zf-vbox zf-layout zf-widget", "hflex": 0, "vflex": 0, "id": "VBox1", "parent": "body", "spacing": "0px"});');
            zoof.command('EXEC zoof.setProps("VBox1", "flex", (0, 0));');
            zoof.command('EXEC zoof.createLabel({"pos": [0, 0], "className": "zf-label zf-widget", "text": "Flex 0 0 0", "hflex": 0, "vflex": 0, "id": "Label2", "parent": "VBox1"});');
            zoof.command('EXEC zoof.setProps("Label2", "flex", (0, 0));');
            zoof.command('EXEC zoof.createHBox({"margin": "0px", "pos": [0, 0], "className": "zf-hbox zf-layout zf-widget", "hflex": 0, "vflex": 0, "id": "HBox3", "parent": "VBox1", "spacing": "0px"});');
            zoof.command('EXEC zoof.setProps("HBox3", "flex", (0, 0));');
            zoof.command('EXEC zoof.createButton({"pos": [0, 0], "className": "zf-button zf-widget", "text": "Hola", "hflex": 0, "vflex": 0, "id": "Button4", "parent": "HBox3"});');
            zoof.command('EXEC zoof.setProps("Button4", "flex", (0, 0));');
            zoof.command('EXEC zoof.createButton({"pos": [0, 0], "className": "zf-button zf-widget", "text": "Hello world", "hflex": 0, "vflex": 0, "id": "Button5", "parent": "HBox3"});');
            zoof.command('EXEC zoof.setProps("Button5", "flex", (0, 0));');
            zoof.command('EXEC zoof.createButton({"pos": [0, 0], "className": "zf-button zf-widget", "text": "Foo bar", "hflex": 0, "vflex": 0, "id": "Button6", "parent": "HBox3"});');
            zoof.command('EXEC zoof.setProps("Button6", "flex", (0, 0));');
            zoof.command("EXEC zoof.get('HBox3').applyLayout();");
            zoof.command('EXEC zoof.createLabel({"pos": [0, 0], "className": "zf-label zf-widget", "text": "Flex 1 0 3", "hflex": 0, "vflex": 0, "id": "Label7", "parent": "VBox1"});');
            zoof.command('EXEC zoof.setProps("Label7", "flex", (0, 0));');
            zoof.command('EXEC zoof.createHBox({"margin": "0px", "pos": [0, 0], "className": "zf-hbox zf-layout zf-widget", "hflex": 0, "vflex": 0, "id": "HBox8", "parent": "VBox1", "spacing": "0px"});');
            zoof.command('EXEC zoof.setProps("HBox8", "flex", (0, 0));');
            zoof.command('EXEC zoof.createButton({"pos": [0, 0], "className": "zf-button zf-widget", "text": "Hola", "hflex": 1, "vflex": 1, "id": "Button9", "parent": "HBox8"});');
            zoof.command('EXEC zoof.setProps("Button9", "flex", (1, 1));');
            zoof.command('EXEC zoof.createButton({"pos": [0, 0], "className": "zf-button zf-widget", "text": "Hello world", "hflex": 0, "vflex": 0, "id": "Button10", "parent": "HBox8"});');
            zoof.command('EXEC zoof.setProps("Button10", "flex", (0, 0));');
            zoof.command('EXEC zoof.createButton({"pos": [0, 0], "className": "zf-button zf-widget", "text": "Foo bar", "hflex": 3, "vflex": 3, "id": "Button11", "parent": "HBox8"});');
            zoof.command('EXEC zoof.setProps("Button11", "flex", (3, 3));');
            zoof.command("EXEC zoof.get('HBox8').applyLayout();");
            zoof.command('EXEC zoof.createLabel({"pos": [0, 0], "className": "zf-label zf-widget", "text": "margin 10 (around layout)", "hflex": 0, "vflex": 0, "id": "Label12", "parent": "VBox1"});');
            zoof.command('EXEC zoof.setProps("Label12", "flex", (0, 0));');
            zoof.command('EXEC zoof.createHBox({"margin": "10px", "pos": [0, 0], "className": "zf-hbox zf-layout zf-widget", "hflex": 0, "vflex": 0, "id": "HBox13", "parent": "VBox1", "spacing": "0px"});');
            zoof.command('EXEC zoof.setProps("HBox13", "flex", (0, 0));');
            zoof.command('EXEC zoof.createButton({"pos": [0, 0], "className": "zf-button zf-widget", "text": "Hola", "hflex": 1, "vflex": 1, "id": "Button14", "parent": "HBox13"});');
            zoof.command('EXEC zoof.setProps("Button14", "flex", (1, 1));');
            zoof.command('EXEC zoof.createButton({"pos": [0, 0], "className": "zf-button zf-widget", "text": "Hello world", "hflex": 1, "vflex": 1, "id": "Button15", "parent": "HBox13"});');
            zoof.command('EXEC zoof.setProps("Button15", "flex", (1, 1));');
            zoof.command('EXEC zoof.createButton({"pos": [0, 0], "className": "zf-button zf-widget", "text": "Foo bar", "hflex": 1, "vflex": 1, "id": "Button16", "parent": "HBox13"});');
            zoof.command('EXEC zoof.setProps("Button16", "flex", (1, 1));');
            zoof.command("EXEC zoof.get('HBox13').applyLayout();");
            zoof.command('EXEC zoof.createLabel({"pos": [0, 0], "className": "zf-label zf-widget", "text": "spacing 10 (inter-widget)", "hflex": 0, "vflex": 0, "id": "Label17", "parent": "VBox1"});');
            zoof.command('EXEC zoof.setProps("Label17", "flex", (0, 0));');
            zoof.command('EXEC zoof.createHBox({"margin": "0px", "pos": [0, 0], "className": "zf-hbox zf-layout zf-widget", "hflex": 0, "vflex": 0, "id": "HBox18", "parent": "VBox1", "spacing": "10px"});');
            zoof.command('EXEC zoof.setProps("HBox18", "flex", (0, 0));');
            zoof.command('EXEC zoof.createButton({"pos": [0, 0], "className": "zf-button zf-widget", "text": "Hola", "hflex": 1, "vflex": 1, "id": "Button19", "parent": "HBox18"});');
            zoof.command('EXEC zoof.setProps("Button19", "flex", (1, 1));');
            zoof.command('EXEC zoof.createButton({"pos": [0, 0], "className": "zf-button zf-widget", "text": "Hello world", "hflex": 1, "vflex": 1, "id": "Button20", "parent": "HBox18"});');
            zoof.command('EXEC zoof.setProps("Button20", "flex", (1, 1));');
            zoof.command('EXEC zoof.createButton({"pos": [0, 0], "className": "zf-button zf-widget", "text": "Foo bar", "hflex": 1, "vflex": 1, "id": "Button21", "parent": "HBox18"});');
            zoof.command('EXEC zoof.setProps("Button21", "flex", (1, 1));');
            zoof.command("EXEC zoof.get('HBox18').applyLayout();");
            zoof.command('EXEC zoof.createWidget({"pos": [0, 0], "className": "zf-widget", "hflex": 1, "vflex": 1, "id": "Widget22", "parent": "VBox1"});');
            zoof.command('EXEC zoof.setProps("Widget22", "flex", (1, 1));');
            zoof.command('EXEC zoof.createLabel({"pos": [0, 0], "className": "zf-label zf-widget", "text": "Note the spacer Widget above", "hflex": 0, "vflex": 0, "id": "Label23", "parent": "VBox1"});');
            zoof.command('EXEC zoof.setProps("Label23", "flex", (0, 0));');
            zoof.command("EXEC zoof.get('VBox1').applyLayout();");
        };
    </script>
    <script>"use strict";function decodeUtf8(arrayBuffer){var result="",i=0,c=0,c1=0,c2=0,c3=0,data=new window.Uint8Array(arrayBuffer);if(data.length>=3&&data[0]===0xef&&data[1]===0xbb&&data[2]===0xbf){i=3;}while(i<data.length){c=data[i];if(c<128){result+=String.fromCharCode(c);i+=1;}else if(c>191&&c<224){if(i+1>=data.length){throw "UTF-8 Decode failed. Two byte character was truncated.";}c2=data[i+1];result+=String.fromCharCode(((c&31)<<6)|(c2&63));i+=2;}else{if(i+2>=data.length){throw "UTF-8 Decode failed. Multi byte character was truncated.";}c2=data[i+1];c3=data[i+2];result+=String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63));i+=3;}}return result;}</script>
    <script>"use strict";zoof.widgets={};zoof.AUTOFLEX=729;zoof.get=function(id){if(id==='body'){return document.body;}else{return zoof.widgets[id];}};zoof.createWidgetElement=function(type,D){var e=document.createElement(type),par;e.id=D.id;zoof.widgets[D.id]=e;e.className=D.className;e.hflex=D.hflex;e.vflex=D.vflex;e.zfInfo=D;e.style.left=(D.pos[0]>1 ? D.pos[0]+"px":D.pos[0]*100+"%");e.style.top=(D.pos[1]>1 ? D.pos[1]+"px":D.pos[1]*100+"%");par=zoof.get(D.parent);if(typeof par.appendWidget==='function'){par.appendWidget(e);}else{par.appendChild(e);}e.checkResize=function(){setTimeout(e.checkResizeNow,0);};e.storedSize=[0,0];e.checkResizeNow=function(){var i,func,event;event=new window.CustomEvent("resize");event.widthChanged=(e.storedSize[0] !==e.clientWidth);event.heightChanged=(e.storedSize[1] !==e.clientHeight);if(event.widthChanged||event.heightChanged){e.storedSize=[e.clientWidth,e.clientHeight];e.dispatchEvent(event);}};e.checkResize();if(par===document.body){window.addEventListener('resize',e.checkResize,false);}else{par.addEventListener('resize',e.checkResize,false);}return e;};zoof.setProps=function(id){var i,e=zoof.get(id);for(i=0;i<arguments.length;i+=2){e[arguments[i]]=arguments[i+1];}};zoof.setStyle=function(id){var i,e=zoof.get(id);for(i=1;i<arguments.length;i+=2){e.style[arguments[i]]=arguments[i+1];}};zoof.createWidget=function(D){var e=zoof.createWidgetElement('div',D);return e;};zoof.createLabel=function(D){var e=zoof.createWidgetElement('div',D);e.innerHTML=D.text;return e;};zoof.createButton=function(D){var e=zoof.createWidgetElement('button',D);e.innerHTML=D.text;return e;};zoof.createBox=function(D){var e;e=zoof.createWidgetElement('div',D);e.style.padding=D.margin;e.applyLayout=function(){};e.applyBoxStyle=function(e,sty,value){var prefix,prefixes,i;prefixes=['-webkit-','-ms-','-moz-',''];for(i=0;i<prefixes.length;i+=1){prefix=prefixes[i];e.style[prefix+sty]=value;}};return e;};zoof.createHBox=function(D){var e=zoof.createBox(D);e.appendWidget=function(child){e.appendChild(child);e.applyBoxStyle(child,'flex-grow',child.hflex);if(child.hflex>0){e.applyBoxStyle(child,'flex-basis',0);}if(e.children.length>1){child.style['margin-left']=D.spacing;}};e.applyBoxStyle(e,'align-items','center');e.applyBoxStyle(e,'justify-content','space-around');return e;};zoof.createVBox=function(D){var e=zoof.createBox(D);e.appendWidget=function(child){e.appendChild(child);e.applyBoxStyle(child,'flex-grow',child.vflex);if(child.vflex>0){e.applyBoxStyle(child,'flex-basis',0);}};e.applyBoxStyle(e,'align-items','stretch');e.applyBoxStyle(e,'justify-content','space-around');return e;};zoof.createTableHBox=function(D){var e,row;e=zoof.createWidgetElement('table',D);row=document.createElement("tr");e.appendChild(row);e.style.padding=D.margin;e.appendWidget=function(child){var td=document.createElement("td");row.appendChild(td);td.appendChild(child);if(row.children.length>1){td.style['padding-left']=D.spacing;}};e.applyLayout=function(){zoof.applyTableLayout(this);};e.applyCellLayout=function(row,col,vflex,hflex,cum_vflex,cum_hflex){col.style.height='100%';if(hflex===0){col.className='';col.style.width='auto';}else{col.className='hflex';col.style.width=hflex*100/cum_hflex+'%';}};};zoof.createTableVBox=function(D){var e=zoof.createWidgetElement('table',D);e.appendWidget=function(child){var tr=document.createElement("tr"),td=document.createElement("td");this.appendChild(tr);tr.appendChild(td);td.appendChild(child);};e.applyLayout=function(){zoof.applyTableLayout(this);};e.applyCellLayout=function(row,col,vflex,hflex,cum_vflex,cum_hflex){row.vflex=vflex;if(vflex===0){col.className='hflex';row.style.height='auto';}else{col.className='vflex hflex';row.style.height=vflex*100/cum_vflex+'%';}};e.addEventListener('resize',zoof.adaptLayoutToSizeChange,false);};zoof.createForm=function(D){var e=zoof.createWidgetElement('table',D);e.appendChild(document.createElement("tr"));e.appendWidget=function(child){var row,td,itemsinrow;row=e.children[e.children.length-1];itemsinrow=row.children.length;if(itemsinrow>=2){row=document.createElement("tr");e.appendChild(row);}td=document.createElement("td");row.appendChild(td);td.appendChild(child);child.hflex=(row.children.length===1 ? 0:1);};e.applyLayout=function(){zoof.applyTableLayout(this);};e.applyCellLayout=function(row,col,vflex,hflex,cum_vflex,cum_hflex){var className='';if((vflex===zoof.AUTOFLEX)||(vflex===0)){row.style.height='auto';className+='';}else{row.style.height=vflex*100/cum_vflex+'%';className+='vflex';}className+=' ';if(hflex===0){col.style.width='auto';className+='';}else{col.style.width='100%';className+='hflex';}col.className=className;};e.addEventListener('resize',zoof.adaptLayoutToSizeChange,false);};zoof.createGrid=function(D){var e=zoof.createWidgetElement('table',D);e.appendChild(document.createElement("tr"));e.appendWidget=function(child){var i,j,row,cell;i=child.zfInfo.pos[1];j=child.zfInfo.pos[0];while(i>=e.children.length){e.appendChild(document.createElement("tr"));}row=e.children[i];while(j>=row.children.length){row.appendChild(document.createElement("td"));}cell=row.children[j];cell.appendChild(child);};e.applyLayout=function(){zoof.applyTableLayout(this);};e.applyCellLayout=function(row,col,vflex,hflex,cum_vflex,cum_hflex){var className='';if(vflex===0){row.style.height='auto';className+='';}else{row.style.height=vflex*100/cum_vflex+'%';className+='vflex';}className+=' ';if(hflex===0){col.style.width='auto';className+='';}else{col.style.width=hflex*100/cum_hflex+'%';className+=' hflex';}col.className=className;};e.addEventListener('resize',zoof.adaptLayoutToSizeChange,false);};zoof.createPinBoard=function(D){var e=zoof.createWidgetElement('div',D);e.applyLayout=function(){};};zoof.applyTableLayout=function(table){var row,col,i,j,nrows,ncols,vflexes,hflexes,cum_vflex,cum_hflex;nrows=table.children.length;ncols=0;for(i=0;i<nrows;i+=1){row=table.children[i];ncols=Math.max(ncols,row.children.length);}if(nrows===0||ncols===0){return;}vflexes=[];hflexes=[];for(i=0;i<nrows;i+=1){row=table.children[i];for(j=0;j<ncols;j+=1){col=row.children[j];if((col===undefined)||(col.children.length===0)){continue;}vflexes[i]=Math.max(vflexes[i]||0,col.children[0].vflex||0);hflexes[j]=Math.max(hflexes[j]||0,col.children[0].hflex||0);}}cum_vflex=vflexes.reduce(function(pv,cv){return pv+cv;},0);cum_hflex=hflexes.reduce(function(pv,cv){return pv+cv;},0);if(cum_vflex===0){for(i=0;i<vflexes.length;i+=1){vflexes[i]=zoof.AUTOFLEX;}cum_vflex=vflexes.length*zoof.AUTOFLEX;}if(cum_hflex===0){for(i=0;i<hflexes.length;i+=1){hflexes[i]=zoof.AUTOFLEX;}cum_hflex=hflexes.length*zoof.AUTOFLEX;}for(i=0;i<nrows;i+=1){row=table.children[i];row.vflex=vflexes[i]||0;for(j=0;j<ncols;j+=1){col=row.children[j];if((col===undefined)||(col.children.length===0)){continue;}table.applyCellLayout(row,col,vflexes[i],hflexes[j],cum_vflex,cum_hflex);}}};zoof.adaptLayoutToSizeChange=function(event){var table,row,col,i,j,cum_vflex,remainingHeight,remainingPercentage,maxHeight;table=event.target;if(event.heightChanged){for(i=0;i<table.children.length;i+=1){row=table.children[i];if(row.vflex>0){row.style.height='100%';break;}}remainingHeight=table.clientHeight;cum_vflex=0;for(i=0;i<table.children.length;i+=1){row=table.children[i];cum_vflex+=row.vflex;if((row.vflex===0)&&(row.children.length>0)){remainingHeight-=row.children[0].clientHeight;}}remainingPercentage=100*remainingHeight/table.clientHeight;for(i=0;i<table.children.length;i+=1){row=table.children[i];if(row.vflex>0){row.style.height=Math.round(row.vflex/cum_vflex*remainingPercentage)+1+'%';}}}};</script>
    <script>"use strict";zoof.init=function(){if(zoof.isExported){zoof.runExportedApp();}else{zoof.initSocket();zoof.initLogging();}};zoof.exit=function(){if(zoof.ws){zoof.ws.close();}};window.addEventListener('load',zoof.init,false);window.addEventListener('beforeunload',zoof.exit,false);zoof.command=function(msg){var log,link;log=document.getElementById('log');if(msg.search('EVAL ')===0){window._=eval(msg.slice(5));zoof.ws.send('RET '+window._);}else if(msg.search('EXEC ')===0){eval(msg.slice(5));}else if(msg.search('TITLE ')===0){document.title=msg.slice(6);}else if(msg.search('ICON ')===0){link=document.createElement('link');link.rel='icon';link.href=msg.slice(5);document.getElementsByTagName('head')[0].appendChild(link);}else if(msg.search('OPEN ')===0){window.win1=window.open(msg.slice(5),'new','chrome');}else{log.innerHTML+=msg+"<br />";}};zoof.initSocket=function(){var loc,url,ws;zoof.lastmsg=null;if(window.WebSocket===undefined){document.body.innerHTML='This browser does not support WebSockets';return;}loc=location;url="ws://"+loc.hostname+':'+loc.port+"/"+loc.pathname+"/ws";ws=new window.WebSocket(url);zoof.ws=ws;ws.binaryType="arraybuffer";ws.onmessage=function(evt){var msg;zoof.lastmsg=evt.data;msg=decodeUtf8(evt.data);zoof.command(msg);};ws.onclose=function(ev){document.body.innerHTML='Lost connection with GUI server:<br >';document.body.innerHTML+=ev.reason+" ("+ev.code+")";};ws.onopen=function(ev){var log=document.getElementById('log');log+='Socket connected'+"<br />";};ws.onerror=function(ev){var log=document.getElementById('log');log.innerHTML+='Socket error'+ev.error+"<br />";};};zoof.initLogging=function(){var errorHandler;console.ori_log=console.log;console.ori_info=console.info||console.log;console.ori_warn=console.warn||console.log;console.log=function(msg){zoof.ws.send("INFO "+msg);console.ori_log(msg);};console.info=function(msg){zoof.ws.send("INFO "+msg);console.ori_info(msg);};console.warn=function(msg){zoof.ws.send("WARN "+msg);console.ori_warn(msg);};window.addEventListener('error',errorHandler,false);errorHandler=function(ev){var intro="On line "+ev.lineno+" in "+ev.filename+":";zoof.ws.send("ERROR "+intro+'\n    '+ev.message);};};</script>    
        
    <!--
    <div>
        <input type="text" id="msg" value="message">
        <input type="submit" id="send" value="send" /><br />
    </div>
    -->
    <div id="log" style="display: none;"> LOG:<br><br></div>

</body>
</html>
